# 開發說明

## 建置輸出與發布位置
- `src/options/**` 會編譯成 `dist/options.js`，由 `options.html` 載入。
- `src/content/**` 會編譯成 `scripts/content.js`，由 `manifest.json` 的 content scripts 載入。
- 發布/打包時會包含 `dist/` 與 `scripts/`，`src/` 不會出現在發佈檔案中。
- 請勿直接修改 `scripts/content.js`，應修改 `src/content/**` 再建置。

## 常用指令
- `bun run build`：建置 options + content，輸出到 `dist/` 與 `scripts/`。
- `bun run typecheck`：TypeScript 型別檢查。
- `bun test`：Bun 測試。
- `bun run test:js`：Node 測試（只測 `scripts/content-utils.js`）。
- `bun run validate`：typecheck + tests + build。
- `bun run pack:release`：與發佈流程一致的本地打包（關閉 debug + 產生 zip）。

## Debug 旗標
- debug 由編譯期常數 `__CHATGPT_TOOLKIT_DEBUG__` 控制。
- 預設為開啟（未設定環境變數時）。
- 發佈流程會設 `CHATGPT_TOOLKIT_DEBUG=false`，避免上線版本輸出 debug log。
- 本地建置示例（PowerShell）：
  - `$env:CHATGPT_TOOLKIT_DEBUG='false'; bun run build`

## 發佈/打包內容
- 發佈流程會先 build，再打包為 zip。
- zip 內容包含：
  - `_locales/`, `images/`, `scripts/`, `dist/`, `options.html`,
  - `manifest.json`, `README.md`, `CHANGELOG.md`
- `options.html` 與 `dist/` 必須一起打包，否則選項頁會無法載入。
